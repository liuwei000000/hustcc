!function($){var d=function(a,b){this.init('cascade',a,b);};d.prototype={constructor:d,init:function(a,b,c){this.type=a;this.$element=$(b);this.options=this.getOptions(c);this.layout()},getOptions:function(a){a=$.extend({},$.fn[this.type].defaults,this.$element.data(),a);return a},layout:function(){$('.additem').remove();this.item();this.endDecorate();this.box()},item:function(){var b=this.$element,_coord=[],_num=0,_options=this.options,i=0,$items=b.find(this.options.fallsCss),fallsWidth=$items.eq(0).outerWidth()+this.options.margin,boxWidth=b.outerWidth()+this.options.margin,_autoWidth=0;_num=Math.floor(boxWidth/fallsWidth);_autoWidth=(boxWidth-_num*fallsWidth)/2;for(;i<_num;i++){_coord.push([i*fallsWidth,0])}$items.each(function(){var a=$(this),fallsHeight=a.outerHeight()+_options.margin,temp=0;for(i=0;i<_num;i++){if(_coord[i][1]<_coord[temp][1]){temp=i}}a.stop().animate({left:_coord[temp][0]+_autoWidth+'px',top:_coord[temp][1]+'px'});_coord[temp][1]+=fallsHeight;a.on('mouseenter'+'.'+_options.type,function(){$(this).addClass('hover');});a.on('mouseleave'+'.'+_options.type,function(){$(this).removeClass('hover');});});this.coord=_coord;this.num=_num;this.autoWidth=_autoWidth;},box:function(){this.$element.height(this.getFallsMaxHeight());},endDecorate:function(){var a=this.coord,i=0,_num=this.num,fallsMaxHeight=this.getFallsMaxHeight(),falls=document.createElement('div'),fallsClone,fallsHeight=0;falls.className='additem';for(;i<_num;i++){if(fallsMaxHeight!=a[i][1]){fallsClone=falls.cloneNode();fallsHeight=fallsMaxHeight-this.options.margin-a[i][1];this.$element.append($(fallsClone).stop().animate({left:a[i][0]+this.autoWidth+'px',top:a[i][1]+'px',height:fallsHeight+'px'}));}}},getFallsMaxHeight:function(){var c=0,i=0,heightArry=[],_coord=this.coord,_num=this.num;for(;i<_num;i++){heightArry.push(_coord[i][1]);}heightArry.sort(function(a,b){return a-b;});return heightArry[_num-1];}};var e=$.fn.cascade;$.fn.cascade=function(b){return this.each(function(){var a=$(this),data=a.data('cascade'),options=typeof b=='object'&&b;if(!data){a.data('cascade',data=new d(this,options));$(window).on('resize.cascade',function(){data['layout']();});}if(typeof b=='string'){data[b]();}});};$.fn.cascade.Constructor=d;$.fn.cascade.defaults={fallsCss:'.item',margin:15};$.fn.cascade.noConflict=function(){$.fn.cascade=e;return this;}}(window.jQuery);